<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 4.8.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Antonio Caliò">

  
  
  
    
  
  <meta name="description" content="Apache kafka is a distributed streaming platform.
  What is Event Streaming?
Event streaming is the practice of capturing data in real-time from event sources like databases, sensors or mobile devices.">

  
  <link rel="alternate" hreflang="en-us" href="/courses/bdanalytics/kafka/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/courses/bdanalytics/kafka/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Antonio Caliò">
  <meta property="og:url" content="/courses/bdanalytics/kafka/">
  <meta property="og:title" content="Introduction to Apache Kafka | Antonio Caliò">
  <meta property="og:description" content="Apache kafka is a distributed streaming platform.
  What is Event Streaming?
Event streaming is the practice of capturing data in real-time from event sources like databases, sensors or mobile devices."><meta property="og:image" content="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>Introduction to Apache Kafka | Antonio Caliò</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Antonio Caliò</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Antonio Caliò</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>



  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
    
  

  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/scalaintro/">Introduction to Scala and its Build System</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkeco/">The Spark Ecosystem</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/advancedspark/">Spark (More) Advanced Examples</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparksql/">Introduction to Spark SQL</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkgraphx/">Working with Graphs</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkmllib/">Machine Learning with Spark</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkstreaming/">Structured Streaming</a>

  </div>
  
  <div class="docs-toc-item active">
    <a class="docs-toc-link" href="/courses/bdanalytics/kafka/">Introduction to Apache Kafka</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/exampleproject/">Example Project</a>

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents"></nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Introduction to Apache Kafka</h1>

          <div class="article-style">
            <p>Apache kafka is a distributed streaming platform.</p>
<ol>
<li>
<p>What is Event Streaming?</p>
<p>Event streaming is the practice of capturing data in real-time from
event sources like databases, sensors or mobile devices.</p>
<p>With event-streaming you need to design your application as an event-driven
application. This means that events your application has constantly to reach
to what is happening in its surrounding environment.</p>
<p>Event streaming nsures a continuous flow and interpretation of data so that the right information is at the right
time.</p>
</li>
<li>
<p>What can I use event streaming for?</p>
<p>There is number of different contexts where real-time processing is a real thing.
For instance:</p>
<ul>
<li>To process payments and financial transactions</li>
<li>To track and monitor cars, trucks, fleets and shipments</li>
<li>To continuously capture and analyze sensor data coming from and IoT ecosystem</li>
<li>To collect and immediately react to customer interactions and orders</li>
<li>To monitor patients in a hospital to ensures timely treatment in emergencies</li>
<li>To connect, store and make available data produced by different division of a company</li>
<li>To serve as the foundation for data platforms and event-driven architectures</li>
</ul>
</li>
<li>
<p>Apache Kafka in the real world</p>
<p>Here is a list of company that are using Kafka:</p>
<ul>
<li><em>The New York Times</em></li>
<li><em>Pinterest</em></li>
<li><em>zalando</em></li>
<li><em>line</em></li>
<li><em>adidas</em></li>
<li><em>airbnb</em></li>
<li><em>cisco</em></li>
</ul>
</li>
<li>
<p>What does it mean to be an event streaming platform?</p>
<p>Kafka combines together three key capabilities:</p>
<ul>
<li><strong>publish</strong> (write) and <strong>subscribe to</strong> (read) to stream of events</li>
<li><strong>store</strong> streams of events in a durable and reliable fashion</li>
<li><strong>process</strong> streams of event as they occur or retrospectively</li>
</ul>
<p>All this functionality is provided in a distributed, highly scalable, elastic, fault-tolerant and
secure manner.</p>
</li>
<li>
<p>How does Kafka work in a nutshell?</p>
<p>The Kafka system consists of <strong>servers</strong> and <strong>clients</strong> communicating with each over via high-performance
TCP network protocol.</p>
<ul>
<li><strong>SERVERS</strong>. Kafka runs on a cluster comprising several servers which can be distributed across different
datacenters or cloud regions.
One of  the advantage of using Kafka as a cluster is that if a server goes down there is always
another server that  will cover for the failed server – this means being fault-tolerant.</li>
<li><strong>CLIENTS</strong>. In the client-side of a Kafka application are to one in charge of the process either
writing or process the stream of events.
Kafka has several client libraries that allows you to develop kafka clients in a variety of
different languages.</li>
</ul>
</li>
<li>
<p>Main Concepts and Terminology</p>
<p>Kafka is built around the following concepts:</p>
<ul>
<li>
<p><strong>Event</strong>. Generally speaking, an event records the fact that <em>something happened</em> in your business world.
An event is often referred as <strong>message</strong>.
An event is associated with a key, and it has a value and a timestamp (plus, optional metadata).
An example is the following:</p>
<ul>
<li>Event Key: &ldquo;Alice&rdquo;</li>
<li>Event Value: &ldquo;Made a payment to Bob&rdquo;</li>
<li>Event timestamp: &ldquo;Sept 29, 2020 at 11:00&rdquo;</li>
</ul>
</li>
<li>
<p><strong>Producers</strong> and <strong>Consumers</strong>.  The producers are all the client applications that write the events
on Kafka, while the consumers are those application that <em>subscribe</em> to these events, thus they are
the one consuming the data produced by the producers.
Kafka provides several guarantees, for instance with Kafka you have the guarantee that each event
will be processed exactly once</p>
</li>
<li>
<p><strong>Topics</strong>. Event are organized in topics. They resemble the concept of folder within a file system.
For instance, you can have a topic called &ldquo;payments&rdquo; that records all the transactions that happened
in your business.</p>
<p>A topic can have zero-to-multiple producers or receivers.</p>
<p>Events can be consumed any time, in fact they can reside with the Kafka storage system for
an arbitrarily long time, without affecting the performance of the application. In fact,
one cool feature about Kafka is that its operations are constant with respect to the data size.
Therefore, storing data for a long time is perfectly fine.</p>
</li>
<li>
<p><strong>Partitions</strong>. Usually, a topic is spread across different &ldquo;buckets&rdquo; located on different Kafka
brokers.
When an event occurs, it is actually appended to one of the topic partitions,
Kafka is able to guarantee:</p>
<ul>
<li>Events with same event key are always written in the same partition</li>
<li>Consumers  read the event within the same partition in the exact order of arrival</li>
</ul>








  











<figure id="figure-a-topic-with-four-partitions">


  <a data-fancybox="" href="/media/img/kafka-partititons.png" data-caption="A topic with four partitions">


  <img src="/media/img/kafka-partititons.png" alt=""  >
</a>


  
  
  <figcaption>
    A topic with four partitions
  </figcaption>


</figure>

</li>
<li>
<p><strong>Replica</strong>. In order to achieve the fault-tolerance and high-availability each topic is
replicated across different datacenters or geographical regions.
Therefore there are always multiple brokers that have a copy of the data, just in case something
goes wrong.
A commonly used setting is to use a replication factor of 3 – these each data is copied three times.</p>
</li>
</ul>
</li>
</ol>
<p>The code for this lesson is available <a href="https://github.com/acalio/BDAnalytics/tree/main/08-Kafka" target="_blank" rel="noopener">here</a>.</p>
<h1 id="quickstart">QuickStart</h1>
<ol>
<li>
<p>Step-1: Download Kafka from: <a href="https://downloads.apache.org/kafka/2.6.0/kafka_2.13-2.6.0.tgz" target="_blank" rel="noopener">https://downloads.apache.org/kafka/2.6.0/kafka<sub>2.13</sub>-2.6.0.tgz</a></p>
<pre><code>wget https://downloads.apache.org/kafka/2.6.0/kafka_2.13-2.6.0.tgz
tar -xzf kafka_2.13-2.6.0.tgz
cd kafka_2.13-2.6.0
</code></pre>
</li>
<li>
<p>Step-2: Start the Kafka Environment</p>
<p>First you need to activate the Zookeeper service.</p>
<pre><code>zookeper-server-start.sh config/zookeper.properties
</code></pre>
<p>In another terminal session run:</p>
<pre><code>kafka-server-start.sh config/server.properties
</code></pre>
</li>
<li>
<p>Step-3: Create a topic to store your events</p>
<p>Before you can write your first event you have to create a topic.</p>
<p>In order to create a topic, you must issue the following command:</p>
<pre><code>kafka-topics.sh --create --topic quickstart-events --bootstrap-server localhost:9092
</code></pre>
<p>If you want to obtain some information on the topic you have just created, you need to issue the
following command:</p>
<pre><code>kafka-topics.sh --describe --topic quickstart-events --bootstrap-server localhost:9092
</code></pre>
</li>
<li>
<p>Step-4: Setup a producer and a consumer from the command line</p>
<p>First you need to setup a <em>producer</em>. There is a built-in command line tool.</p>
<pre><code>$ kafka-console-producer.sh --topic quickstart-events --bootstrap-server localhost:9092
</code></pre>
<p>Then you can produce messages directly from the console:</p>
<pre><code>&gt; my first event
&gt; my second event
</code></pre>
<p>There is also a built-in command line tool for the consumer.
You can run the following command:</p>
<pre><code>kafka-console-consumer.sh --topic quickstart-events --from-beginning --bootstrap-server localhost:9092
</code></pre>
</li>
</ol>
<h1 id="kafka-architecture">Kafka Architecture</h1>
<p>Kafka is essentially a commit with a very simple data structure that is able
to be extremely fault tolerant and (horizontally) scalable.</p>
<p>The Kafka commit log is basically ad queue where the records cannot be directly
deleted or modified, but they can only be appended at the end of the data structure.</p>
<p>The order of items stored in the queue reflects the order of arrival to the system.
In particular, for all the messages stored in the same partition kafka guarantees its order.</p>
<p>Because of this strong guarantee, records are immutable, once they are in the queue
they cannot be modified.</p>
<p>Moreover, Kafka automatically assigns each record with a unique sequential ID, known
as &ldquo;offset&rdquo;.</p>








  











<figure id="figure-kafka-offset">


  <a data-fancybox="" href="/media/img/kafka-offset.png" data-caption="Kafka Offset">


  <img src="/media/img/kafka-offset.png" alt=""  >
</a>


  
  
  <figcaption>
    Kafka Offset
  </figcaption>


</figure>

<h1 id="component-overview">Component Overview</h1>
<p>In the Kafka architecture the following entities are involved:</p>
<ul>
<li>Topics</li>
<li>Producers</li>
<li>Consumers</li>
<li>Consumers groups</li>
<li>Clusters</li>
<li>Brokers</li>
<li>Partitions</li>
<li>Replicas</li>
<li>Leaders</li>
<li>Followers</li>
</ul>
<p>The following diagram provides a high lever overview of how
these components interact with each others








  











<figure id="figure-kafka-components-overview">


  <a data-fancybox="" href="/media/img/kafka-component.png" data-caption="Kafka components overview">


  <img src="/media/img/kafka-component.png" alt=""  >
</a>


  
  
  <figcaption>
    Kafka components overview
  </figcaption>


</figure>
</p>
<h1 id="kafka-api-architecture">Kafka API Architecture</h1>
<p>There are four different APIs:</p>
<ol>
<li><strong>Producer API</strong>. It enables an application to publish a stream of records to one
or more Kafka topics.</li>
<li><strong>Consumer API</strong>. It enables an application to subscribe to one or more Kafka topics.
It also enables an application to process the stream of data deriving from the topic it
is subscribed to.</li>
<li><strong>Streams API</strong>. It enables an application to process  input streams and to produce
other streams as output. It is very useful when you need to design stream-oriented applications</li>
<li><strong>Connect API</strong>. It connects application or data systems to Kafka topics.
For instance, with the Connect API, a connector could capture all the updates
to a database and ensure that all the updates are available within a Kafka topic</li>
</ol>
<h1 id="kafka-cluster-architecture">Kafka Cluster Architecture</h1>
<p>Here is a list of the main Kafka components within a Kafka cluster.</p>
<ol>
<li>
<p>Broker</p>
<p>Any server within a Kafka cluster is considered a Kafka Broker.
Brokers achieves the requirement of fault-tolerance, reliability and
availability at the heart of the Kafka ecosystem.</p>
<p>Each broker is able to handle, thus to read and write, hundreds of messages every second.</p>
<p>A broker has a unique ID and it responsible for a number of partitions belonging to one of
more topics.</p>
<p>The brokers leverage ZooKeper to elect a leader among them. A leader is in charge
for dealing with client requests directed towards a particular partition.</p>
<p>Clearly, the more brokers are in the cluster, the higher the reliability of the entire
system will be.</p>
</li>
<li>
<p>Apache Zookeeper Architecture</p>
<p>ZooKeper is the manager of the entire cluster.
It knows, every time, who are the nodes involved in the cluster and
it notifies the other brokers when something changes in terms of
topics added or removed.</p>
<p>For instance, when a new Broker joins the cluster, ZooKeper is responsible for
informing the entire cluster. It does the same thing also when a Borker fails.</p>
<p>Furthermore, the ZooKeeper coordinates the  elections of the leader of each partition.</p>
<p>The election is run every time something changes from the broker perspective.</p>
</li>
<li>
<p>Producer</p>
<p>It represents a data source. The process that publishes messages to
one or more Kafka topics.</p>
<p>A Kafka producer is also able to balance the data among  different brokers</p>
</li>
<li>
<p>Consumer</p>
<p>It reads data by reading messages directly from the topics it is subscribed to.</p>
</li>
</ol>
<h1 id="kafka-architecture-1">Kafka Architecture</h1>
<p>The following concepts are the main concepts required to understand the entire
framework.</p>
<ol>
<li>
<p>Kafka Topic</p>
<p>It is basically a channel through which data is streamed.</p>
<p>Producers publish their messages to topics while consumers read messages from
the topic thy are subscribed to.</p>
<p>Topics are useful because they provide the ability of organizing messages within
groups. A topic is identified with a unique names within the same Kafka cluster.</p>
<p>There is no limit to the number of topics that can be created on the same cluster.</p>
</li>
<li>
<p>Kafka Partitions</p>
<p>Topics are divided into partitions.
The partitions are also replicated across the different brokers partecipating to
a Kafka cluster.</p>
<p>From each partition, multiple consumers and producers can read and write in parallel.</p>
<p>All the messages  that have the same keys will be written on the same partition.</p>
<p>As regards messages without a key, they will be written among different partitions in
a round robin fashion.</p>
<p>Messages with the same key will be processed respecting the order of their arrival.</p>
<p>There is no limit on the number of different partitions that can be created on
topic.</p>
</li>
<li>
<p>Topic Replication Factor</p>
<p>Replicating data is essential in order to achieve both availability and reliability.
The replication factor determines how many replicas are there for every topic.</p>
<p>It is defined on the topic level and it applies on the partition level.</p>
<p>For instance, a topic replication factor of 3 means that each partition, belonging to
that topic, will be replicated 3 times.</p>
<p>Given a topic, for each partition a broker is elected as leaders while the other ones
are in charge of keeping the replicas.</p>
<p>Clearly, the replication factor cannot be greater than the total number of brokers.</p>
<p>When a replica is up to date with the leader is said to be an In-Sync Replica (ISR)</p>
</li>
<li>
<p>Consumer Group</p>
<p>A group of consumers includes all the consumers that share a common task.</p>
<p>When Kafka sends messages to a group of consumers, each individual consumer is assigned
to a particular partition, then only that particular consumer will read from that partition.
This means that there is a one-to-one relationship between partitions and consumers within
the group. As a consequence, if the number of consumer within group exceeds the number
partitions, some consumer will be inactive.</p>
</li>
</ol>
<h1 id="understanding-the-entire-architecture">Understanding the entire Architecture</h1>
<p>Here we focus on understanding how the components
presented above cooperate with each others.</p>
<ol>
<li>Example 1: One Consumer, One Producer</li>
</ol>








  











<figure id="figure-one-producer-one-consumer">


  <a data-fancybox="" href="/media/img/kafka-example1.png" data-caption="One Producer, One Consumer">


  <img src="/media/img/kafka-example1.png" alt=""  >
</a>


  
  
  <figcaption>
    One Producer, One Consumer
  </figcaption>


</figure>

<ol start="2">
<li>
<p>Example 2: One Producer, Multiple Consumers








  











<figure id="figure-one-producers-multiple-consumers">


  <a data-fancybox="" href="/media/img/kafka-example2.png" data-caption="One Producers, Multiple Consumers">


  <img src="/media/img/kafka-example2.png" alt=""  >
</a>


  
  
  <figcaption>
    One Producers, Multiple Consumers
  </figcaption>


</figure>
</p>
</li>
<li>
<p>Example 3: Consumer Groups








  











<figure id="figure-consumer-groups">


  <a data-fancybox="" href="/media/img/kafka-example3.png" data-caption="Consumer Groups">


  <img src="/media/img/kafka-example3.png" alt=""  >
</a>


  
  
  <figcaption>
    Consumer Groups
  </figcaption>


</figure>
</p>
</li>
</ol>

          </div>

          



          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          






  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses/bdanalytics/kafka.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          


          


  
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.832c0c66be3ec862b3635a8119cc9647.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
