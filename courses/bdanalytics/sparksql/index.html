<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 4.8.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Antonio Caliò">

  
  
  
    
  
  <meta name="description" content="SparkSQL is a library for structured data processing. It provides an abstraction mechanism – the main one is called DataFrame – which can serve as a distributed SQL query engine.">

  
  <link rel="alternate" hreflang="en-us" href="/courses/bdanalytics/sparksql/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/courses/bdanalytics/sparksql/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Antonio Caliò">
  <meta property="og:url" content="/courses/bdanalytics/sparksql/">
  <meta property="og:title" content="Introduction to Spark SQL | Antonio Caliò">
  <meta property="og:description" content="SparkSQL is a library for structured data processing. It provides an abstraction mechanism – the main one is called DataFrame – which can serve as a distributed SQL query engine."><meta property="og:image" content="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu28aae1bbe67b568759c86bc74a5bbfe0_150966_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>Introduction to Spark SQL | Antonio Caliò</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Antonio Caliò</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Antonio Caliò</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>



  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
    
  

  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/scalaintro/">Introduction to Scala and its Build System</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkeco/">The Spark Ecosystem</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/advancedspark/">Spark (More) Advanced Examples</a>

  </div>
  
  <div class="docs-toc-item active">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparksql/">Introduction to Spark SQL</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkgraphx/">Working with Graphs</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bdanalytics/sparkmllib/">Machine Learning with Spark</a>

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#features-of-a-dataframe">Features of a DataFrame</a></li>
    <li><a href="#running-sql-queries">Running SQL Queries</a></li>
  </ul>

  <ul>
    <li><a href="#dataframe-vs-dataset">DataFrame vs DataSet</a></li>
    <li><a href="#dataset-vs-rdd">DataSet vs RDD</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Introduction to Spark SQL</h1>

          <div class="article-style">
            <p>SparkSQL is a library for structured data processing.
It provides an abstraction mechanism – the main one is called <code>DataFrame</code> – which can
serve as  a distributed SQL query engine.</p>
<p>Spark SQL offers the following features:</p>
<ul>
<li>
<p><strong>Integrated</strong>.</p>
<ul>
<li>Seamlessly mix SQL queries with Spark programs.</li>
<li>Spark SQL lets you query structured data as a distributed dataset (RDD) in Spark</li>
<li>This tight integration makes it easy to run SQL queries alongside complex analytic algorithms</li>
</ul>
</li>
<li>
<p><strong>Unified Data Access</strong></p>
<ul>
<li>Load and query data from a variety of different sources like: Apache Hive tables, parquet files, JSON files, etc.</li>
</ul>
</li>
<li>
<p><strong>Scalability</strong></p>
<ul>
<li>Use the same engine for both interactive and long queries</li>
<li>SparkSQL leverages on the RDD model to provide fault tolerance an scalability</li>
</ul>
</li>
</ul>
<p>The code for this lesson is available <a href="https://github.com/acalio/BDAnalytics/tree/main/04-Spark-SQL" target="_blank" rel="noopener">here</a>.</p>
<h1 id="architecture">Architecture</h1>








  











<figure id="figure-sparksql-architecture">


  <a data-fancybox="" href="/media/img/arch.png" data-caption="SparkSQL architecture">


  <img src="/media/img/arch.png" alt=""  >
</a>


  
  
  <figcaption>
    SparkSQL architecture
  </figcaption>


</figure>

<p>The architecture contains three layers namely:</p>
<ol>
<li>Language API − Spark is compatible with different languages and Spark SQL. It is also, supported by these languages- API (python, scala, java, HiveQL).</li>
<li>Schema RDD − Spark Core is designed with special data structure called RDD. Generally, Spark SQL works on schemas, tables, and records. Therefore, we can use the Schema RDD as temporary table. We can call this Schema RDD as Data Frame.</li>
<li>Data Sources − Usually the Data source for spark-core is a text file, Avro file, etc. However, the Data Sources for Spark SQL is different. Those are Parquet file, JSON document, HIVE tables, and Cassandra database.</li>
</ol>
<h1 id="what-is-a-dataframe">What is a DataFrame</h1>
<p>A DataFrame is a distributed collection of data,
which is organized into named columns.
You can think of a DataFrame as a relational table.</p>
<p>DataFrames can be constructed from a variety of different sources such as Hive tables, Structured Data files,
external database, or also an existing RDD.</p>
<h2 id="features-of-a-dataframe">Features of a DataFrame</h2>
<ul>
<li>
<p>Ability to process the data in the size of Kilobytes to Petabytes on a single node cluster to large cluster</p>
</li>
<li>
<p>Supports different data formats (Avro, csv, elastic search, and Cassandra) and storage systems (HDFS, HIVE tables, mysql, etc).</p>
</li>
<li>
<p>State of art optimization and code generation through the Spark SQL Catalyst optimizer (tree transformation framework).</p>
</li>
<li>
<p>Can be easily integrated with all Big Data tools and frameworks via Spark-Core.</p>
</li>
<li>
<p>Optimized application of udf function over the entire dataframe.
The following instructions will create a new column whose values are given by the column value to the power of two</p>
<p>import org.apache.spark.sql.functions.udf
val square = (x=&gt; x*x)
val squaredDF = df.withColumn(&ldquo;square&rdquo;, square(&ldquo;value&rdquo;))</p>
</li>
<li>
<p>Example</p>
<p>Imagine you have the following data, formatted as a JSON file:</p>
<pre><code>{
   {&quot;id&quot; : &quot;1201&quot;, &quot;name&quot; : &quot;satish&quot;, &quot;age&quot; : &quot;25&quot;}
   {&quot;id&quot; : &quot;1202&quot;, &quot;name&quot; : &quot;krishna&quot;, &quot;age&quot; : &quot;28&quot;}
   {&quot;id&quot; : &quot;1203&quot;, &quot;name&quot; : &quot;amith&quot;, &quot;age&quot; : &quot;39&quot;}
   {&quot;id&quot; : &quot;1204&quot;, &quot;name&quot; : &quot;javed&quot;, &quot;age&quot; : &quot;23&quot;}
   {&quot;id&quot; : &quot;1205&quot;, &quot;name&quot; : &quot;prudvi&quot;, &quot;age&quot; : &quot;23&quot;}
}
</code></pre>
<p>You can read this file and create a dataframe as follows:</p>
<pre><code>...
val spark = SparkSession
      .builder
      .appName(&quot;SparkSQL&quot;)
      .master(&quot;local[*]&quot;)
      .getOrCreate()
val df =  spark.sqlContext.read.json(&quot;example.json&quot;)
df.show()
</code></pre>
<p>The last instruction returns the following result:</p>
<pre><code>+----+------+--------+
|age | id   |  name  |
+----+------+--------+
| 25 | 1201 | satish |
| 28 | 1202 | krishna|
| 39 | 1203 | amith  |
| 23 | 1204 | javed  |
| 23 | 1205 | prudvi |
+----+------+--------+
</code></pre>
<p>You can access to the structure underlying a dataframe as follows:</p>
<pre><code>df.printSchema
</code></pre>
<p>In this case it returns the following:</p>
<pre><code>root
   |-- age: string (nullable = true)
   |-- id: string (nullable = true)
   |-- name: string (nullable = true)
</code></pre>
<p>You handle a DataFrame in a very similar fashion to a Pandas dataframe.</p>
<p>For instance:</p>
<pre><code>df.select(&quot;name&quot;).show 
</code></pre>
<p>Or also</p>
<pre><code>// This import is needed to use the $-notation
import spark.sqlContext.implicts._ 
df.select($&quot;name&quot;).show 
</code></pre>
<p>It returns:</p>
<pre><code>+--------+
|  name  |
+--------+
| satish |
| krishna|
| amith  |
| javed  |
| prudvi |
+--------+
</code></pre>
<p>You can use filter:</p>
<pre><code>dfs.filter(dfs(&quot;age&quot;) &gt; 23).show()
</code></pre>
<p>It returns:</p>
<pre><code>+----+------+--------+
|age | id   | name   |
+----+------+--------+
| 25 | 1201 | satish |
| 28 | 1202 | krishna|
| 39 | 1203 | amith  |
+----+------+--------+
</code></pre>
<p>You can group and apply aggregate functions to your data as follows:</p>
<pre><code>dfs.groupBy(&quot;age&quot;).count().show()
</code></pre>
<p>It returns:</p>
<pre><code>+----+-----+
|age |count|
+----+-----+
| 23 |  2  |
| 25 |  1  |
| 28 |  1  |
| 39 |  1  |
+----+-----+
</code></pre>
</li>
</ul>
<h2 id="running-sql-queries">Running SQL Queries</h2>
<p>An SQLContext enables applications to run SQL queries programmatically while running SQL functions and returns the result as a DataFrame.</p>
<p>Generally, in the background, SparkSQL supports two different methods for converting existing RDDs into DataFrames.</p>
<ul>
<li>
<p>Inferring the schema via reflection</p>
<p>This method uses reflection to generate the schema of an RDD that contains specific types
of objects. The Scala interface for Spark SQL supports automatically converting an RDD containing case classes to a DataFrame.
The <strong>case class</strong> defines the schema of the table. The names
of the arguments to the case class are read using reflection and they become the names of the columns.</p>
<p>Case classes can also be nested or contain complex
types such as Sequences or Arrays. This RDD can be implicitly be
converted to a DataFrame and then registered as a table.
Tables can be used in subsequent SQL statements.</p>
<ul>
<li>
<p>Example</p>
<p>Imagine you are given with the following data:</p>
<pre><code>1201, satish, 25
1202, krishna, 28
1203, amith, 39
1204, javed, 23
1205, prudvi, 23
</code></pre>
<p>First you need to define a case class – which is  class that only define its contructor – to provide your data with a fixed structure:</p>
<pre><code>case class Employee(id: Int, name: String, age: Int)
</code></pre>
<p>Next, you create an RDD mapping each line to the above case class and then convert it to a DataFrame</p>
<pre><code>val spark = SparkSession
      .builder
      .appName(&quot;SparkSQL&quot;)
      .master(&quot;local[*]&quot;)
      .getOrCreate()
        
val df =  spark.sparkContext.textFile(&quot;employee.txt&quot;)
   .map(_.split(&quot;,&quot;)).map(e=&gt;Employee(e(0).trim.toInt, e(1), e(2).trim.toInt)).toDF
df.show()
</code></pre>
<p>Now you have a fully functional data frame. If you want to use the SQL engine your first need to register
the dataframe as a table:</p>
<pre><code>empl.registerTempTable(&quot;employee&quot;) //set the name of the table associated with the dataset
</code></pre>
<p>Then your can perform regular SQL query as follows:</p>
<pre><code>spark.sqlContext.sql(&quot;Select * from employee*&quot;).show
</code></pre>
<p>It returns:</p>
<pre><code>+------+---------+----+
|  id  |  name   |age |
+------+---------+----+
| 1201 | satish  | 25 |
| 1202 | krishna | 28 |
| 1203 | amith   | 39 |
| 1204 | javed   | 23 |
| 1205 | prudvi  | 23 |
+------+---------+----+
</code></pre>
<p>SparkSQL understands any sql query – so if you know SQL you are good to go.</p>
</li>
</ul>
</li>
<li>
<p>Specify the schema programmatically</p>
<p>The second method for creating DataFrame is through programmatic interface that allows you to construct a schema and then apply it to an existing RDD. We can create a DataFrame programmatically using the following three steps.</p>
<ul>
<li>
<p>Create an RDD of Rows from an Original RDD.</p>
</li>
<li>
<p>Create the schema represented by a StructType matching the structure of Rows in the RDD created in Step 1.</p>
</li>
<li>
<p>Apply the schema to the RDD of Rows via createDataFrame method provided by SQLContext.</p>
</li>
<li>
<p>Example</p>
<p>Imagine you are given with the following data:</p>
<pre><code>1201, satish, 25
1202, krishna, 28
1203, amith, 39
1204, javed, 23
1205, prudvi, 23
</code></pre>
<p>Next, you create an RDD from the text file.</p>
<pre><code>//remember to include these imports
import org.apache.spark.sql.Row
import org.apache.spark.sql.types.{StructType, StructField, StringType}
        
val spark = SparkSession
      .builder
      .appName(&quot;SparkSQL&quot;)
      .master(&quot;local[*]&quot;)
      .getOrCreate()
        
val df =  spark.sparkContext.textFile(&quot;employee.txt&quot;)
</code></pre>
<p>Now, instead of defining a case class as we did earlier, we define schema with a String.</p>
<pre><code>val schemaString = &quot;id name age&quot;
</code></pre>
<p>The above string is then used to generate a schema as follows:</p>
<pre><code>val schema = StructType(schemaString.split(&quot; &quot;).map(fieldName =&gt; =StructField(fieldName, StringType, true)))
</code></pre>
<p>Use the following command to convert an RDD (employee) to Rows. It means, here we are specifying the logic for reading the RDD data and store it into rowRDD. Here we are using two map functions: one is a delimiter for splitting the record string (.map(<sub>.split</sub>(&quot;,&quot;))) and the second
map function for defining a Row with the field index
value (.map(e ⇒ Row(e(0).trim.toInt, e(1), e(2).trim.toInt))).</p>
<pre><code>val rowRDD = employee.map(_.split(&quot;,&quot;)).map(e ⇒ Row(e(0).trim.toInt, e(1), e(2).trim.toInt))
val employeeDF = sqlContext.createDataFrame(rowRDD, schema)
</code></pre>
</li>
</ul>
</li>
</ul>
<h1 id="comparative-evaluation">Comparative evaluation</h1>
<h2 id="dataframe-vs-dataset">DataFrame vs DataSet</h2>
<p>They are basically the same object, namely a collection of structured data
– for instance DataSet[Person], DataSet[(String, Double)].</p>
<p>Actually, a <code>DataFrame</code> is an alias for <code>Dataset[Row]</code>.</p>
<p>The major difference between the two is that the structure of the data contained within
a  <code>DataFrame</code>  is inferred at runtime, while for a <code>DataSet</code> object Scala is able to infer the
actual type of the objects at compile time.
Clearly, this second mechanism is beneficial in terms of performance and it is also less prone
to potential errors.</p>
<h2 id="dataset-vs-rdd">DataSet vs RDD</h2>
<p>An RDD can be converted to a <code>DataSet</code> object with the method <code>toDS</code>.</p>
<p>DataSets are more convenient than RDD for the following reasons:</p>
<ul>
<li>better efficiency</li>
<li>better interoperability with other libraries:
<ul>
<li>MLlib relies on Datasets</li>
<li>Spark streaming is moving towards structured streaming</li>
<li>Everything that use apache Avro</li>
</ul>
</li>
</ul>
<hr>
<p>The material for this lesson is available  <a href="https://github.com/acalio/BDAnalytics/tree/main/04-Spark-SQL/" target="_blank" rel="noopener">here</a></p>

          </div>

          



          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          






  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses/bdanalytics/sparkSQL.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          


          


  
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.832c0c66be3ec862b3635a8119cc9647.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
